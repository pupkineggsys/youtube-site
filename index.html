<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ikumin Channel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #667eea;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: white;
            text-align: center;
        }
        #videos {
            background: yellow;
            padding: 20px;
            margin: 20px;
        }
        .video-item {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
        }
        .video-item img {
            max-width: 300px;
            display: block;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>ikumin Channel - テスト</h1>

    <div id="videos" style="background:yellow; padding:20px;">
        読み込み前...
    </div>

    <script>
        var videosDiv = document.getElementById('videos');

        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'https://api.rss2json.com/v1/api.json?rss_url=https://www.youtube.com/feeds/videos.xml?channel_id=UCD-KiPyXa3YXGPijH2mDJXg');
        xhr.onload = function() {
            var data = JSON.parse(xhr.responseText);
            var html = '<p style="color:green; font-size:20px;">動画 ' + data.items.length + ' 件取得成功!</p>';

            for (var i = 0; i < data.items.length; i++) {
                var item = data.items[i];

                // リンクからビデオIDを抽出（複数の形式に対応）
                var videoId = null;
                var link = item.link;

                // watch?v= 形式
                if (link.indexOf('watch?v=') !== -1) {
                    videoId = link.split('watch?v=')[1];
                    if (videoId.indexOf('&') !== -1) {
                        videoId = videoId.split('&')[0];
                    }
                }
                // shorts/ 形式
                else if (link.indexOf('/shorts/') !== -1) {
                    videoId = link.split('/shorts/')[1];
                    if (videoId.indexOf('?') !== -1) {
                        videoId = videoId.split('?')[0];
                    }
                }
                // youtu.be 形式
                else if (link.indexOf('youtu.be/') !== -1) {
                    videoId = link.split('youtu.be/')[1];
                }

                html += '<div class="video-item">';
                html += '<p><strong>リンク:</strong> ' + link + '</p>';
                html += '<p><strong>VideoID:</strong> ' + videoId + '</p>';

                if (videoId) {
                    html += '<img src="https://img.youtube.com/vi/' + videoId + '/mqdefault.jpg">';
                }
                html += '<p><strong>' + item.title + '</strong></p>';
                html += '</div>';
            }
            videosDiv.innerHTML = html;
        };
        xhr.send();
    </script>
</body>
</html>
